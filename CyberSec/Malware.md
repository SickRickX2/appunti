>[!note] NIST 800-83
>“A program that is inserted into a system, usually
covertly, with the intent of compromising the
confidentiality, integrity, or availability of the
victim’s data, applications, or operating system or
otherwise annoying or disrupting the victim.”
### Classification of Malware
**Classified into two broad categories:**
Based first on how it spreads or propagates to reach the desired targets.
Then on the actions or payloads it performs once a target is reached.

**Also classified by:**
Those that need a host program (parasitic code such as viruses).
Those that are independent, self-contained programs (worms, trojans, and bots).
Malware that does not replicate (trojans and spam e-mail).
Malware that does replicate (viruses and worms).
### Types of Malicious Software (Malware)

*Propagation mechanisms include:*

- Infection of existing content by viruses that is subsequently spread to other systems.
- Exploit of software vulnerabilities by worms or drive-by-downloads to allow the malware to replicate
- Social engineering attacks that convince users to bypass security mechanisms to install. Trojans or to respond to phishing attacks.

*Payload actions performed by malware once it reaches a target system can include:*
- Corruption of system or data files
- Theft of service/make the system a zombie agent of attack as part of a botnet
- Theft of information from the system/keylogging
- Stealthing/hiding its presence on the system

### Advanced Persistent Threats (APTs)

Well-resourced, persistent application of a wide variety of intrusion technologies and
malware to selected targets (usually business or political)
-  Typically attributed to state-sponsored organizations and criminal enterprises
- Differ from other types of attack by their careful target selection and stealthy intrusion efforts over extended periods
- High profile attacks include Aurora, RSA, APT1, and Stuxnet

### APT Characteristics
>[!note] Advanced
>Used by attackers of a wide variety of intrusion technologies and malware including the develpoment of custom malware if required. The individual components may not necessarily be technically advanced but are carefully selected to suit the chosen target.

>[!note] Persistent
>Determined application of attacks over an extended period against the chosen target in order to maximize the chance of success. A variety of attacks may be progressively applied until the target is compromised.

>[!note] Threats
>Threats to the selected targets as a result of the organized, capable and well funded attackers intent to compromise the specificaly chosen targets. The active involvement of people in the process greatly raises the threat level from that due to automated attack tools and also the lilelihood of successful attacks

#### ATP Attacks
**Aim**: 
- Varies from theft of intellectual property or security and infrastructure related data to the physical distruption of infrastructure
**Technique used:**
- social engineering
- spear-phishing email
- drive-by-downlads from selected compromised websites likely to be visted by personnel in the target organization
**Intent:**
- To infect the target with sophisticated malware with multiple propagation mechanism and payloads
- Once they have gained initial access to systems  in the target organization a further rnage of attack tools are used to amintain and extend their access
## Viruses
Piece of software that infects programs, modifes them to include a copy of the virus, replicates and goes om to infect other content, easily spread through network environments.
It can do everything that the program infected is permitted to, it executes secretly when the host program is run.
### Virus components
*Infection mechanism*
Means by which a virus spread or propagates.
Also referred to as **infection vector**
*Trigger*
Event/Condition that determines when teh payloas is activated or deliveres. Sometimes known as **logic bomb**
*Payload*
What the virus does (besides spreading). May involve damage or beningn but noticeable activity.

### Virus Classification by target
- Boots sector infector
	- Infects a master boot record or boot record and spreads when a system is booted from the disk containing the virus
- File infector
	- Infects files that the operating system or shell considers to be executable
- Macro virus
	- Infects files with macro or scripting code that is interpreted by an application
- Multipartite virus
	- Infects files in multiple ways

### Virus Classifications by concealment strategy
- Encrypted virus
	- A portion that mutates with every infection
- Stealth virus
	- A form of virus explicitly designed to hide itself from detection by anti-virus software 
- Polymorphic virus
	- A virus mutates with every infection
- Metamorphic virus
	- A virus that mutates and rewrites itself completely at each interation and may change behavior as well as appearance

### Worms
- Program that actively seek out more machines to infect and each infected machine serves as an automated launching pad for attacks on other machines
- Exploits software vulnerabilities in client or server programs
- Can use a network connections to spread from system to system
- Upon activation the worm may replicate and propagate again
- Usually carries some form of payload

>[!note] Worm Replication
> *Electronic mail or instant messenger facility*: worm e-mails a copy of itself to other systems.
> *File sharing*: Creates a copy of itself or infects a file as a virus on removable media
> *Remote execution capability*: Worm executes a copy of itself on another system
> *Remote file access or transfer capability:* Worm uses a remote file access or transfer service to copy itself from one system to the other
> *Remote login capability*:  Worm logs onto a remote system as a user and then uses commands to copy itself from one system to the other



### Target Discovery
- *Scanning (or fingerprinting)*
	- Searches for other systems to infect
- *Random*
	- Each compromised host probes random addressed in the IP address space using different seed
	- This produces a high volume of Internet traffic which may cause generalized disruption even before the actual attack is launched
- *Hit List*
	- the attacker first compiles a long list of potential vulnreable machins
	- Once the list is compiled the attacker begins infecting machines on the list
	- Each infected machine is provided with a portion of the list to scan
- *Topological*
	- This method uses information contained on an infected victim machine to find more hosts to scan
- *Local subnet*
	- If an host can be infected by a firewall that host then looks for targets in its own local network
	- The host uses the subnet structure to find other hosts that would otherwise be protected by the firewall

>[!note] Dive-by-downloads
>Exploits browser and plugin vulnerabilities. The user views a webpage controlled by the attacker and it contains code that expoilts the bug to download and install malware on the system without user's knowledge or consent. It usually spreads when users visit the malicious webpage.

>[!note] Watering-Hole Attacks
>A variant of drive by download used in higly targeted attacks. The attacker researches their intended victims to identify websites they are likely to visit, then scans these sites to identify those with vulnerabilities that allow their compromise. They then wait for one of their intended victims to visit one of compromised sites. This greatly increases the likelihood of the site compromise remaining undetected.

>[!note] Malvertising
>The attacker pays for advertisements that have malware in them in target websites.

>[!note] Clickjacking
>Also known as a user-interface *redress attack*.
>Using a similar technique, keystrokes can halso be hijacked. Basically the user thinks he s clicking or typing in the right place but instead they are typing into an invisible frame controlled by the attacker.

### Social Engineering for malware propagation
- **Spam**
- **Trojan horse**
- **Mobile phone Trojan**

### Ransomware
When installed on infected systems, it encryptes a large number of files and then demands a ransom payment to recover them.
## Payload

### System corruption
- Real world damage: causes damage to physical equipment
- Logic bomb: code embedded in the malware that is set to "explode" when certain conditions are met
>[!note] Attack Agents Bots
>**Botnet** collection of bots capable of acting in a coordinated manner
>Uses:
>- DDoS attacks
>- Spam
>- Sniffing
>- Keylogging
>- Spreading new malware
>- Installing advertisement add-ons and browser helper objects
>- Attacking IRC chat network
>- Manipulating online polls/games

>[!note] Remote Control Facility
>Distinguises a bot from a worm, a worm is automated while a bot is initially controlled from some central facility.

### Information Theft
>[!note] Keylogger
>Captures keystrokes to allow attacker to monitor sensitive information. Typically uses some form of filtering mechanism that only returns information close to keywords ( logins, password)

>[!note] Spyware
>It monitors a wide range of activity on the system. 
>- redirecting certain web page requests to fake sites
>- monitoring history and content of browsing activity

>[!note] Phishing
>Exploits social engineering to leverage the user's trust by masquerading as communication from a trusted source
>>[!tip] Spear phishing
>>Is a customized attack on a specific employee and company

## Stealthing
**Rootkit**
Set of hidden programs installed on a system to maintain covert access to that system. Hides subverting the mechanisms that monitor and report on the processes, files, and registries on a computer.
Gives administrator (or root) privileges to attacker.
- Can add or change programs and files, monitor processes, send and receive network traffic, and get backdoor access on demand.

>[!note] Rootkit Classification Characteristics
>- *Persistent* **Memory based**
>- *User Mode* **Kernel mode**
>- *Virtual Machine Based* **External mode**

### Malware Countermeasure Approaches
The ideal solution is *prevention*.
We got 4 main elements of prevention:
- **Policy**
- **Awareness**
- **Vulnerability mitigation**
- **Threat mitigation**
If prevention fails, technical mechanisms can be used to support the following threat mitigation options:
- **detection**
- **identification**
- **removal**

>[!tip] Generations of Anti-Virus Software
>1) Simple scanners
>2) Heuristic scanners
>3) Activity traps
>4) Full featured protection

#### Sandbox Analysis
It consists in running potentially malicious code in an emulated sandbox or on a virtual machine.
The code is executed in a controlled environment and it can be closely monitored without threat
























